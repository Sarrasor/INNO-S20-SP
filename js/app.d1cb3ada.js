(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],u=0,p=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);d&&d(e);while(p.length)p.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,o=1;o<s.length;o++){var l=s[o];0!==n[l]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},n={app:0},a=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/INNO-S20-SP/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"204c":function(t,e,s){"use strict";var i=s("d7d2"),n=s.n(i);n.a},"446b":function(t,e,s){},"4d71":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var i=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("Instruction",{attrs:{instructions:t.instructions},on:{select:t.selectInstruction,upload:t.uploadInstruction}}),s("Step",{attrs:{steps:t.steps},on:{select:t.selectStep}}),s("Asset",{attrs:{assets:t.assets}}),s("Render",{attrs:{assets:t.assets,files:t.files}})],1)},a=[],r=(s("4de4"),s("7db0"),s("4160"),s("c975"),s("b0c0"),s("159b"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"card"},[s("p",{staticClass:"label bold"},[t._v("instructions")]),t.instructions?[s("div",{staticClass:"toolbar"},[t.instructions?s("button",{attrs:{tooltip:"create new"},on:{click:t.createInstruction}},[s("i",{staticClass:"material-icons-outlined"},[t._v("add")])]):t._e(),t.instruction?[s("button",{attrs:{tooltip:"duplicate"},on:{click:t.duplicateInstruction}},[s("i",{staticClass:"material-icons-outlined"},[t._v("library_add")])]),s("button",{attrs:{tooltip:"upload to server"},on:{click:function(e){return t.$emit("upload")}}},[s("i",{staticClass:"material-icons-outlined"},[t._v("publish")])]),s("button",{attrs:{tooltip:"delete"},on:{click:t.deleteInstruction}},[s("i",{staticClass:"material-icons-outlined"},[t._v("delete")])])]:t._e()],2),t.instructions.length>0?s("div",{staticClass:"list",staticStyle:{height:"125px"}},t._l(t.instructions,(function(e,i){return s("button",{key:i,class:{selected:i===t.selected},on:{click:function(e){t.selected=i}}},[t._v(t._s(e.index.name))])})),0):t._e()]:t._e(),t.instruction?[s("p",{staticClass:"label"},[t._v("name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.instruction.index.name,expression:"instruction.index.name"}],attrs:{type:"text"},domProps:{value:t.instruction.index.name},on:{input:function(e){e.target.composing||t.$set(t.instruction.index,"name",e.target.value)}}}),s("p",{staticClass:"label"},[t._v("description")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.instruction.index.description,expression:"instruction.index.description"}],domProps:{value:t.instruction.index.description},on:{input:function(e){e.target.composing||t.$set(t.instruction.index,"description",e.target.value)}}}),t._v(" "),s("p",{staticClass:"label"},[t._v("preview")]),s("FileDrop",{attrs:{types:[1]},model:{value:t.instruction.index.preview_url,callback:function(e){t.$set(t.instruction.index,"preview_url",e)},expression:"instruction.index.preview_url"}})]:t._e()],2),s("div",{staticClass:"card",staticStyle:{"margin-top":"20px",width:"430px"}},[s("p",{staticClass:"label bold"},[t._v("files")]),t.instruction?s("FileUpload",{on:{upload:t.validateMediaLinks},model:{value:t.instruction.files,callback:function(e){t.$set(t.instruction,"files",e)},expression:"instruction.files"}}):t._e()],1)])}),o=[],l=(s("a434"),s("b85c")),c=s("ec26"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:{delete:t.file},attrs:{id:"root"},on:{drop:t.drop,dragover:function(t){return t.preventDefault()},click:function(e){return t.$emit("drop",null)}}},[t.file?s("p",[t._v(t._s(t.file))]):s("p",{staticClass:"label"},[t._v("drag an uploaded file here")])])},u=[],p=(s("caad"),s("2532"),{name:"FileDrop",props:["file","types"],model:{prop:"file",event:"drop"},methods:{drop:function(t){var e=JSON.parse(t.dataTransfer.getData("text"));this.types&&!this.types.includes(e.type)||this.$emit("drop",e.name)}}}),h=p,f=(s("204c"),s("2877")),m=Object(f["a"])(h,d,u,!1,null,"a3bce9aa",null),v=m.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"root"}},[s("div",{staticClass:"list",staticStyle:{height:"125px"}},t._l(t.files,(function(e,i){return s("button",{key:i,attrs:{draggable:""},on:{dragstart:function(e){return t.drag(e,i)}}},[t._v(t._s(e.name))])})),0),s("div",{attrs:{id:"drop"},on:{click:function(e){return t.$refs.input.click()},drop:t.drop,dragover:function(t){return t.preventDefault()}}},[s("p",{attrs:{id:"empty"}},[t._v("click or drag your local files here to upload them")]),s("br"),s("p",{attrs:{id:"empty"}},[t._v("or drag an uploaded file to delete it")]),s("input",{ref:"input",attrs:{hidden:"",multiple:"",type:"file",accept:t.extensions.join()},on:{change:function(e){t.upload(Array.from(e.target.files))}}})])])},y=[],g=(s("99af"),s("0481"),s("a630"),s("d81d"),s("4069"),s("d3b7"),s("ac1f"),s("3ca3"),s("1276"),s("ddb0"),s("3835")),_=(s("96cf"),s("1da1")),x={name:"FileUpload",props:["files"],data:function(){return{images:[".bmp",".jpeg",".jpg",".png"],audios:[".mp3"],videos:[".mp4"],models:[".glb"]}},computed:{types:function(){return[this.images,this.audios,this.videos,this.models]},extensions:function(){return this.types.flat()},names:function(){return this.files.map((function(t){return t.name}))}},methods:{upload:function(t){var e=this;return Object(_["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.t0=e,s.t1=e.files,s.next=4,Promise.all(t.filter((function(t){return!e.names.includes(t.name)})).map(e.readFile));case 4:s.t2=s.sent,s.t3=s.t1.concat.call(s.t1,s.t2),s.t0.$emit.call(s.t0,"upload",s.t3);case 7:case"end":return s.stop()}}),s)})))()},readFile:function(t){var e=this.getType;return new Promise((function(s,i){var n=new FileReader;n.onload=function(){return s({name:t.name,type:e(t.name),content:n.result})},n.onerror=i,n.readAsDataURL(t)}))},getExt:function(t){return"."+t.split(".").pop()},getType:function(t){var e,s=this.getExt(t),i=Object(l["a"])(this.types.entries());try{for(i.s();!(e=i.n()).done;){var n=Object(g["a"])(e.value,2),a=n[0],r=n[1];if(r.includes(s))return a+1}}catch(o){i.e(o)}finally{i.f()}return 0},drop:function(t){var e=this;return Object(_["a"])(regeneratorRuntime.mark((function s(){var i,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(t.preventDefault(),!((null===(i=t.dataTransfer.files)||void 0===i?void 0:i.length)>0)){s.next=6;break}return s.next=4,e.upload(Array.from(t.dataTransfer.files).filter((function(t){return e.extensions.includes(e.getExt(t.name))})));case 4:s.next=8;break;case 6:n=JSON.parse(t.dataTransfer.getData("text")),e.$emit("upload",e.files.filter((function(t){return t.name!==n.name})));case 8:case"end":return s.stop()}}),s)})))()},drag:function(t,e){t.dataTransfer.setData("text/plain",JSON.stringify(this.files[e]))}},model:{prop:"files",event:"upload"}},w=x,k=(s("f647"),Object(f["a"])(w,b,y,!1,null,"351bf185",null)),S=k.exports,C={name:"Instruction",props:["instructions"],components:{FileDrop:v,FileUpload:S},data:function(){return{selected:void 0}},watch:{instructions:function(t){t&&this.selectLast()}},computed:{instruction:function(){var t;return this.$emit("select",this.selected),(null===(t=this.instructions)||void 0===t?void 0:t.length)>0?this.instructions[this.selected]:null}},methods:{validateMediaLinks:function(){var t=this.instruction.files,e=function(e){return!t.find((function(t){return t.name===e}))};e(this.instruction.preview_url)&&(this.instruction.preview_url="");var s,i=Object(l["a"])(this.instruction.steps);try{for(i.s();!(s=i.n()).done;){var n=s.value;e(n.preview_url)&&(n.preview_url="");var a,r=Object(l["a"])(n.assets);try{for(r.s();!(a=r.n()).done;){var o=a.value;e(o.media.url)&&(o.media.url="",o.media.type=0)}}catch(c){r.e(c)}finally{r.f()}}}catch(c){i.e(c)}finally{i.f()}},createInstruction:function(){this.instructions.push({index:{id:Object(c["a"])(),size:0,name:"Instruction "+(this.instructions.length+1),description:"",preview_url:"",step_count:0,last_modified:""},steps:[],files:[]}),this.selectLast()},duplicateInstruction:function(){var t=JSON.parse(JSON.stringify(this.instruction));t.name+=" (copy)",this.instructions.push(t),this.selectLast()},deleteInstruction:function(){this.instructions.splice(this.selected,1),this.selected>=this.instructions.length&&this.selectLast()},selectLast:function(){this.selected=this.instructions.length-1}}},O=C,j=Object(f["a"])(O,r,o,!1,null,null,null),z=j.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"card"},[s("p",{staticClass:"label bold"},[t._v("steps")]),t.steps?[s("div",{staticClass:"toolbar"},[s("button",{attrs:{tooltip:"create new"},on:{click:t.createStep}},[s("i",{staticClass:"material-icons-outlined"},[t._v("add")])]),t.step?[s("button",{attrs:{tooltip:"duplicate"},on:{click:t.duplicateStep}},[s("i",{staticClass:"material-icons-outlined"},[t._v("library_add")])]),s("button",{attrs:{tooltip:"delete"},on:{click:t.deleteStep}},[s("i",{staticClass:"material-icons-outlined"},[t._v("delete")])]),s("button",{attrs:{tooltip:"move up"},on:{click:function(e){return t.reoderSteps(!0)}}},[s("i",{staticClass:"material-icons-outlined"},[t._v("arrow_upward")])]),s("button",{attrs:{tooltip:"move down"},on:{click:function(e){return t.reoderSteps(!1)}}},[s("i",{staticClass:"material-icons-outlined"},[t._v("arrow_downward")])])]:t._e()],2),t.steps.length>0?s("div",{staticClass:"list",staticStyle:{height:"125px"}},t._l(t.steps,(function(e,i){return s("button",{key:i,class:{selected:i===t.selected},on:{click:function(e){t.selected=i}}},[t._v(t._s(e.name))])})),0):t._e()]:t._e(),t.step?[s("p",{staticClass:"label"},[t._v("name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.step.name,expression:"step.name"}],attrs:{type:"text"},domProps:{value:t.step.name},on:{input:function(e){e.target.composing||t.$set(t.step,"name",e.target.value)}}}),s("p",{staticClass:"label"},[t._v("description")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.step.description,expression:"step.description"}],domProps:{value:t.step.description},on:{input:function(e){e.target.composing||t.$set(t.step,"description",e.target.value)}}}),t._v(" "),s("p",{staticClass:"label"},[t._v("preview")]),s("FileDrop",{attrs:{types:[1]},model:{value:t.step.preview_url,callback:function(e){t.$set(t.step,"preview_url",e)},expression:"step.preview_url"}})]:t._e()],2)])},L=[],T={name:"Step",props:["steps"],components:{FileDrop:v},data:function(){return{selected:void 0}},computed:{step:function(){var t;return this.$emit("select",this.selected),(null===(t=this.steps)||void 0===t?void 0:t.length)>0?this.steps[this.selected]:null}},watch:{steps:function(t){t&&this.selectLast()}},methods:{createStep:function(){this.steps.push({name:"Step "+(this.steps.length+1),description:"",preview_url:"",assets:[]}),this.selectLast()},duplicateStep:function(){var t=JSON.parse(JSON.stringify(this.step));t.name+=" (copy)",this.steps.push(t),this.selectLast()},deleteStep:function(){this.steps.splice(this.selected,1),this.selected>=this.steps.length&&this.selectLast()},selectLast:function(){this.selected=this.steps.length-1},reoderSteps:function(t){var e=this.selected+(t?-1:1);if(!(e<0||e>=this.steps.length)){var s=this.steps[e];this.steps[e]=this.steps[this.selected],this.steps[this.selected]=s,this.selected=e}}}},A=T,P=Object(f["a"])(A,$,L,!1,null,null,null),N=P.exports,D=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"card"},[s("p",{staticClass:"label bold"},[t._v("assets")]),t.assets?[s("div",{staticClass:"toolbar"},[s("button",{attrs:{tooltip:"create new"},on:{click:t.createAsset}},[s("i",{staticClass:"material-icons-outlined"},[t._v("add")])]),t.asset?[s("button",{attrs:{tooltip:"duplicate"},on:{click:t.duplicateAsset}},[s("i",{staticClass:"material-icons-outlined"},[t._v("library_add")])]),s("button",{attrs:{tooltip:"awlays face camera"},on:{click:function(e){t.asset.billboard=!t.asset.billboard}}},[t.asset.billboard?s("i",{staticClass:"material-icons-outlined"},[t._v("screen_rotation")]):s("i",{staticClass:"material-icons-outlined"},[t._v("screen_lock_rotation")])]),s("button",{attrs:{tooltip:"toggle visibility"},on:{click:function(e){t.asset.hidden=!t.asset.hidden}}},[t.asset.hidden?s("i",{staticClass:"material-icons-outlined"},[t._v("visibility_off")]):s("i",{staticClass:"material-icons-outlined"},[t._v("visibility")])]),s("button",{attrs:{tooltip:"delete"},on:{click:t.deleteAsset}},[s("i",{staticClass:"material-icons-outlined"},[t._v("delete")])])]:t._e()],2),t.assets.length>0?s("div",{staticClass:"list",staticStyle:{height:"125px"}},t._l(t.assets,(function(e,i){return s("button",{key:i,class:{selected:i===t.selected},on:{click:function(e){t.selected=i}}},[t._v(t._s(e.name))])})),0):t._e()]:t._e(),t.asset?[s("p",{staticClass:"label"},[t._v("name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.asset.name,expression:"asset.name"}],attrs:{type:"text"},domProps:{value:t.asset.name},on:{input:function(e){e.target.composing||t.$set(t.asset,"name",e.target.value)}}}),s("p",{staticClass:"label"},[t._v("description")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.asset.media.description,expression:"asset.media.description"}],domProps:{value:t.asset.media.description},on:{input:function(e){e.target.composing||t.$set(t.asset.media,"description",e.target.value)}}}),t._v(" "),s("p",{staticClass:"label"},[t._v("media")]),s("FileDrop",{model:{value:t.asset.media.url,callback:function(e){t.$set(t.asset.media,"url",e)},expression:"asset.media.url"}}),s("p",{staticClass:"label"},[t._v("position")]),s("Vector",{attrs:{vector:t.asset.transform.position}}),s("p",{staticClass:"label"},[t._v("orientation")]),s("Vector",{attrs:{vector:t.asset.transform.orientation}}),s("p",{staticClass:"label"},[t._v("scale")]),s("input",{attrs:{type:"number",step:"0.1"},domProps:{value:t.asset.transform.scale},on:{input:function(e){t.asset.transform.scale=Math.max(.1,t.$toFloat(e.target.value))}}})]:t._e()],2)])},E=[],I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"root"}},t._l(t.keys,(function(e,i){return s("input",{key:i,style:{width:t.width},attrs:{type:"number",step:"0.1"},domProps:{value:t.vector[e]},on:{input:function(s){t.vector[e]=t.$toFloat(s.target.value)}}})})),0)},F=[],M=(s("b64b"),{name:"Vector",props:["vector"],computed:{keys:function(){return Object.keys(this.vector)},width:function(){return 100/this.keys.length+"%"}}}),R=M,J=(s("ac23"),Object(f["a"])(R,I,F,!1,null,"46ffa12d",null)),B=J.exports,U={name:"Asset",props:["assets"],components:{FileDrop:v,Vector:B},data:function(){return{selected:void 0}},computed:{asset:function(){var t;return this.$emit("select",this.selected),(null===(t=this.assets)||void 0===t?void 0:t.length)>0?this.assets[this.selected]:null}},watch:{assets:function(t){t&&this.selectLast()}},methods:{createAsset:function(){this.assets.push({name:"Asset "+(this.assets.length+1),media:{type:0,url:"",description:""},transform:{position:{x:0,y:0,z:0},orientation:{x:0,y:0,z:0},scale:1},hidden:!1,billboard:!1}),this.selectLast()},duplicateAsset:function(){var t=JSON.parse(JSON.stringify(this.asset));t.name+=" (copy)",this.assets.push(t),this.selectLast()},deleteAsset:function(){this.assets.splice(this.selected,1),this.selected>=this.assets.length&&this.selectLast()},selectLast:function(){this.selected=this.assets.length-1}}},H=U,G=Object(f["a"])(H,D,E,!1,null,"283df44c",null),V=G.exports,q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"card"},[s("canvas",{ref:"canvas"})])},W=[],X=(s("a4d3"),s("e01a"),s("1913"),s("d4ec")),K=s("bee2"),Q=s("5a89"),Y=s("bd2e"),Z=s.n(Y),tt=s("4721");function et(t,e,s){function i(t,e){if(!e||0==e.length)return-1;for(var s=0;s<e.length;s++)if(0==e[s].name.localeCompare(t))return e[s];return-1}var n=new st(t);if(!e||0==e.length)return n;for(var a=0;a<e.length;a++){var r=e[a],o=i(e[a].media.url,s),l=-1==o?null:o;n.createAsset(r.name,l?l.type:0,{media_desc:r.media.description,position:{x:r.transform.position.x,y:r.transform.position.y,z:r.transform.position.z},rotation:{x:r.transform.orientation.x,y:r.transform.orientation.y,z:r.transform.orientation.z},scale:r.transform.scale,billboard:r.billboard,hidden:r.hidden,url:l?l.content:""})}return n}var st=function(){function t(e){Object(X["a"])(this,t),this.node=e,this.createScene(),this.createRenderer(),this.createCamera(),this.createSoftLight(),this.createDirectionalLight(),this.createOrbitControls(),this.createLoader(),this.assets=[]}return Object(K["a"])(t,[{key:"createAsset",value:function(t,e,s){void 0===s&&(s={}),console.log("creating new object");var i=new it(t,e,this.scene,this.camera,this.renderer,{media_desc:s.media_desc,url:s.url,position:{x:s.position.x,y:s.position.y,z:s.position.z},rotation:{x:s.rotation.x,y:s.rotation.y,z:s.rotation.z},scale:s.scale,hidden:s.hidden,billboard:s.billboard,loader:this.loader});return this.assets.push(i),console.log("pushed an object. length: "+this.assets.length),this.assets.length-1}},{key:"updateAsset",value:function(t,e){var s=this.findAssetByName(t);void 0===e&&(e={});var i=this.assets[s];i.name=e.name||i.name,i.media_desc=e.media_desc||i.media_desc,i.hidden=e.hidden||i.hidden,i.billboard=e.billboard||i.billboard,i.setPosition({x:e.position.x||i.model.position.x,y:e.position.y||i.model.position.y,z:e.position.z||i.model.position.z}),i.setOrientation({x:e.rotation.x||i.model.rotation.x,y:e.rotation.y||i.model.rotation.y,z:e.rotation.z||i.model.rotation.z}),i.setScale(e.scale||i.model.scale.x)}},{key:"duplicateAsset",value:function(t,e,s){var i=this.findAssetByName(s),n=this.assets[i];return this.createAsset(t,e,this.scene,this.camera,this.renderer,{media_desc:n.media_desc,billboard:n.billboard,hidden:n.hidden,url:n.url,position:{x:0,y:0,z:0},rotation:{x:n.model.rotation.x,y:n.model.rotation.y,z:n.model.rotation.z},scale:n.model.scale.x})}},{key:"findAssetByName",value:function(t){var e;for(e=0;e<this.assets.length;e++)if(0==this.assets[e].name.localeCompare(t))return e;return-1}},{key:"deleteAsset",value:function(t){var e=this.findAssetByName(t);this.assets.splice(e)}},{key:"createScene",value:function(){this.scene=new Q["Scene"],this.scene.background=new Q["Color"]("gray"),this.scene.add(new Q["AxesHelper"](400))}},{key:"createCamera",value:function(){this.camera=new Q["PerspectiveCamera"](60,2,.1,1e3),this.camera.position.set(40,20,50)}},{key:"createSoftLight",value:function(){var t=new Q["AmbientLight"](4210752);this.scene.add(t)}},{key:"createDirectionalLight",value:function(){var t=new Q["DirectionalLight"](16777215);t.position.set(1,1,1).normalize(),this.scene.add(t)}},{key:"createRenderer",value:function(){this.renderer=new Q["WebGLRenderer"],this.renderer.setSize(this.node.offsetWidth,this.node.offsetHeight),this.renderer.physicallyCorrectLights=!0,this.renderer.outputEncoding=Q["sRGBEncoding"],this.node.appendChild(this.renderer.domElement)}},{key:"createLoader",value:function(){this.loader=new Z.a,console.log("created loader")}},{key:"createOrbitControls",value:function(){this.controls=new tt["a"](this.camera,this.renderer.domElement)}}]),t}(),it=function(){function t(e,s,i,n,a,r){var o=this;Object(X["a"])(this,t),void 0===r&&(r={}),this.name=e,this.media_type=s,this.media_desc=r.media_desc,this.hidden=r.hidden,this.billboard=r.billboard,this.model=new Q["Object3D"],this.loadObject(i,r);var l=function t(){requestAnimationFrame(t),a.render(i,n)};l(),setTimeout((function(){o.setScale(r.scale),o.setPosition({x:r.position.x,y:r.position.y,z:r.position.z}),o.setOrientation({x:r.rotation.x,y:r.rotation.y,z:r.rotation.z}),o.setTransparent(r.hidden)}),200)}return Object(K["a"])(t,[{key:"setPosition",value:function(t){this.model.position.x=t.x,this.model.position.y=t.y,this.model.position.z=t.z}},{key:"setScale",value:function(t){0==this.media_type?this.model.scale.set(t,t/2,1):4==this.media_type?this.model.scale.set(t,t,t):this.billboard?this.model.scale.set(100*t,100*t,1):this.model.scale.set(.2*t,.2*t,1)}},{key:"setOrientation",value:function(t){this.model.rotation.x=t.x,this.model.rotation.y=t.y,this.model.rotation.z=t.z}},{key:"loadObject",value:function(t,e){switch(this.media_type){case 0:this.decideText(t);break;case 1:case 2:case 3:this.decideImage(t,e.url);break;case 4:this.load3DObject(t,e.loader,e.url);break}}},{key:"decideText",value:function(t){this.billboard?this.loadTextSprite(this.media_desc,{fontsize:14}):this.loadText(this.media_desc,{fontsize:14}),t.add(this.model)}},{key:"decideImage",value:function(t,e){console.log("rendering image"),this.billboard?this.loadPictureSprite(e):this.loadPicture(e),t.add(this.model)}},{key:"load3DObject",value:function(t,e,s){var i=this,n=function(e){i.model=e.scene,t.add(i.model)},a=function(){},r=function(t){console.log(t)};e.load(s,(function(t){return n(t)}),a,r)}},{key:"loadText",value:function(t,e){void 0===e&&(e={});var s=s in e?e.fontface:"Arial",i=i in e?e.fontsize:20,n=n in e?e.borderThickness:10,a=document.createElement("canvas"),r=a.getContext("2d");r.font="Bold "+i+"px "+s,r.fillStyle="rgba(0, 0, 0, 1.0)",r.fillText(t,n,i+n);var o=new Q["Texture"](a);o.needsUpdate=!0;var l=new Q["MeshBasicMaterial"]({map:o,side:Q["DoubleSide"]});l.transparent=!0,this.model=new Q["Mesh"](new Q["PlaneGeometry"](a.width,a.height),l)}},{key:"loadTextSprite",value:function(t,e){void 0===e&&(e={});var s=s in e?e.fontface:"Arial",i=i in e?e.fontsize:20,n=n in e?e.borderThickness:10,a=document.createElement("canvas"),r=a.getContext("2d");a.width=512,a.height=512,r.font="Bold "+i+"px "+s,r.fillStyle="rgba(0, 0, 0, 1.0)",r.fillText(t,n,i+n);var o=new Q["Texture"](a);o.needsUpdate=!0;var l=new Q["SpriteMaterial"]({map:o});this.model=new Q["Sprite"](l)}},{key:"loadPicture",value:function(t){var e=document.createElement("canvas"),s=e.getContext("2d");e.width=400,e.height=400;var i=new Q["Texture"](e),n=new Image;n.src=t,n.onload=function(){s.drawImage(n,0,0,e.width,e.height),i.needsUpdate=!0};var a=new Q["MeshBasicMaterial"]({map:i,side:Q["DoubleSide"]});a.transparent=!0,this.model=new Q["Mesh"](new Q["PlaneGeometry"](e.width,e.height),a)}},{key:"loadPictureSprite",value:function(t){var e=(new Q["TextureLoader"]).load(t),s=new Q["SpriteMaterial"]({map:e});this.model=new Q["Sprite"](s)}},{key:"setTransparent",value:function(t,e){this.model.isMesh&&t&&(this.model.material.alphaTest=e)}}]),t}(),nt={name:"Render",props:["assets","files"],watch:{assets:{handler:function(){this.render()},deep:!0},files:{handler:function(){this.render()},deep:!0}},methods:{render:function(){this.$refs.canvas.innerHTML="",et(this.$refs.canvas,this.assets,this.files)}}},at=nt,rt=(s("d4ff"),Object(f["a"])(at,q,W,!1,null,"1c5a9cbc",null)),ot=rt.exports,lt=s("c4e3");i["a"].prototype.$toFloat=function(t){return t=parseFloat(t),isNaN(t)?0:t};var ct={name:"App",components:{Instruction:z,Step:N,Asset:V,Render:ot},data:function(){return{currentInstruction:0,instructions:[],files:[],steps:[],assets:[]}},methods:{selectInstruction:function(t){var e;this.currentInstruction=t;var s=(null===(e=this.instructions)||void 0===e?void 0:e.length)>0?this.instructions[t]:null;this.steps=null===s||void 0===s?void 0:s.steps,this.files=null===s||void 0===s?void 0:s.files},selectStep:function(t){var e;this.assets=(null===(e=this.steps)||void 0===e?void 0:e.length)>0?this.steps[t].assets:null},uploadInstruction:function(){var t=this.instructions[this.currentInstruction],e=t.steps,s=t.files,i=t.index;i.step_count=e.length,i.last_modified=Date.now(),e.forEach((function(t){return t.assets.filter((function(t){return t.media.url})).forEach((function(t){return t.media.type=s.find((function(e){return e.name===t.media.url})).type}))}));var n=new lt;n.file(i.id+"/index.json",JSON.stringify(i)),n.file(i.id+"/steps.json",JSON.stringify(e)),s.forEach((function(t){n.file(i.id+"/media/"+t.name,t.content.substring(t.content.indexOf("base64,")+"base64,".length),{base64:!0})})),n.generateAsync({type:"blob",compression:"DEFLATE"}).then((function(t){var e=new XMLHttpRequest;e.open("POST","https://ad0d9c3e.ngrok.io",!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(t)}))}}},dt=ct,ut=(s("df19"),Object(f["a"])(dt,n,a,!1,null,"cba33912",null)),pt=ut.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(pt)}}).$mount("#app")},"63d7":function(t,e,s){},a705:function(t,e,s){},ac23:function(t,e,s){"use strict";var i=s("4d71"),n=s.n(i);n.a},d4ff:function(t,e,s){"use strict";var i=s("446b"),n=s.n(i);n.a},d7d2:function(t,e,s){},df19:function(t,e,s){"use strict";var i=s("63d7"),n=s.n(i);n.a},f647:function(t,e,s){"use strict";var i=s("a705"),n=s.n(i);n.a}});
//# sourceMappingURL=app.d1cb3ada.js.map